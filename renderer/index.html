<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; font-src 'self' https://fonts.gstatic.com https://fonts.googleapis.com; script-src 'self'">
  <title>PORTFLOW // NETWORK MONITOR</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Scanline overlay -->
  <div class="scanlines"></div>

  <!-- Corporate watermark -->
  <div class="watermark">PORTFLOW CORP</div>

  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <h1 class="logo">
          <span class="logo-bracket">[</span>
          <span class="logo-text">PORTFLOW</span>
          <span class="logo-bracket">]</span>
        </h1>
        <span class="tagline">// NETWORK SURVEILLANCE SYSTEM v1.0</span>
      </div>
      <div class="header-right">
        <div class="status-indicator">
          <span class="status-dot"></span>
          <span class="status-text">MONITORING</span>
        </div>
        <button id="refresh-btn" class="btn btn-primary">
          <span class="btn-icon">&#x27F3;</span>
          REFRESH
        </button>
      </div>
    </header>

    <!-- Tab Navigation -->
    <nav class="tabs">
      <button class="tab active" data-tab="tcp">
        <span class="tab-icon">&#x25C6;</span>
        TCP PORTS
        <span class="tab-count" id="tcp-count">0</span>
      </button>
      <button class="tab" data-tab="udp">
        <span class="tab-icon">&#x25C7;</span>
        UDP PORTS
        <span class="tab-count" id="udp-count">0</span>
      </button>
      <button class="tab" data-tab="forwards">
        <span class="tab-icon">&#x25B7;</span>
        PORT FORWARDS
        <span class="tab-count" id="forwards-count">0</span>
      </button>
      <button class="tab" data-tab="containers">
        <span class="tab-icon">&#x25A3;</span>
        CONTAINERS
        <span class="tab-count" id="containers-count">0</span>
      </button>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- TCP Ports Panel -->
      <div class="panel active" id="panel-tcp">
        <div class="panel-header">
          <span class="panel-title">TCP LISTENING PORTS</span>
          <span class="panel-subtitle">// Active network endpoints</span>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>PORT</th>
                <th>ADDRESS</th>
                <th>STATE</th>
                <th>PID</th>
                <th>PROCESS</th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody id="tcp-table-body">
              <tr class="loading-row">
                <td colspan="6">
                  <div class="loading">SCANNING PORTS<span class="loading-dots"></span></div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- UDP Ports Panel -->
      <div class="panel" id="panel-udp">
        <div class="panel-header">
          <span class="panel-title">UDP LISTENING PORTS</span>
          <span class="panel-subtitle">// Datagram endpoints</span>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>PORT</th>
                <th>ADDRESS</th>
                <th>STATE</th>
                <th>PID</th>
                <th>PROCESS</th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody id="udp-table-body">
              <tr class="loading-row">
                <td colspan="6">
                  <div class="loading">SCANNING PORTS<span class="loading-dots"></span></div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Port Forwards Panel -->
      <div class="panel" id="panel-forwards">
        <div class="panel-header">
          <span class="panel-title">PORT FORWARDS</span>
          <span class="panel-subtitle">// NAT rules and SSH tunnels</span>
        </div>

        <div class="subsection">
          <h3 class="subsection-title">
            <span class="subsection-icon">&#x25B8;</span>
            NAT RULES
            <button id="elevate-iptables-btn" class="btn btn-small btn-warning" style="display: none;">
              ELEVATE ACCESS
            </button>
          </h3>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>CHAIN</th>
                  <th>TARGET</th>
                  <th>PROTOCOL</th>
                  <th>SOURCE</th>
                  <th>DEST PORT</th>
                  <th>TO</th>
                </tr>
              </thead>
              <tbody id="nat-table-body">
                <tr class="loading-row">
                  <td colspan="6">
                    <div class="loading">SCANNING RULES<span class="loading-dots"></span></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="subsection">
          <h3 class="subsection-title">
            <span class="subsection-icon">&#x25B8;</span>
            SSH TUNNELS
          </h3>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>TYPE</th>
                  <th>LOCAL PORT</th>
                  <th>REMOTE HOST</th>
                  <th>REMOTE PORT</th>
                </tr>
              </thead>
              <tbody id="ssh-table-body">
                <tr class="loading-row">
                  <td colspan="4">
                    <div class="loading">SCANNING TUNNELS<span class="loading-dots"></span></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Containers Panel (Docker, Podman, Kubernetes) -->
      <div class="panel" id="panel-containers">
        <div class="panel-header">
          <span class="panel-title">CONTAINERS</span>
          <span class="panel-subtitle" id="runtime-status">// Detecting runtimes...</span>
        </div>
        <div class="runtime-badges" id="runtime-badges">
          <!-- Runtime status badges will be inserted here -->
        </div>
        <div class="table-container">
          <table class="data-table containers-table">
            <thead>
              <tr>
                <th>RUNTIME</th>
                <th>ID / NAME</th>
                <th>IMAGE / NS</th>
                <th>STATUS</th>
                <th>PORTS / IP</th>
                <th>ACTIONS</th>
              </tr>
            </thead>
            <tbody id="containers-table-body">
              <tr class="loading-row">
                <td colspan="6">
                  <div class="loading">SCANNING CONTAINERS<span class="loading-dots"></span></div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-left">
        <span class="footer-stat">
          <span class="stat-label">TOTAL PORTS:</span>
          <span class="stat-value" id="total-ports">0</span>
        </span>
        <span class="footer-stat">
          <span class="stat-label">LAST SCAN:</span>
          <span class="stat-value" id="last-scan">--:--:--</span>
        </span>
      </div>
      <div class="footer-right">
        <span class="footer-info">AUTO-REFRESH: 3s</span>
        <span class="footer-separator">|</span>
        <span class="footer-info">SYSTEM: LINUX</span>
      </div>
    </footer>
  </div>

  <!-- Kill Confirmation Modal -->
  <div class="modal-overlay" id="kill-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-icon">&#x26A0;</span>
        <h2 class="modal-title">TERMINATE PROCESS</h2>
      </div>
      <div class="modal-body">
        <p class="modal-text">You are about to terminate the following process:</p>
        <div class="modal-details">
          <div class="detail-row">
            <span class="detail-label">PID:</span>
            <span class="detail-value" id="modal-pid">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">PROCESS:</span>
            <span class="detail-value" id="modal-process">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">PORT:</span>
            <span class="detail-value" id="modal-port">--</span>
          </div>
        </div>
        <p class="modal-warning">This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="modal-cancel">CANCEL</button>
        <button class="btn btn-danger" id="modal-confirm">TERMINATE</button>
      </div>
    </div>
  </div>

  <!-- Container Action Modal -->
  <div class="modal-overlay" id="container-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-icon">&#x25A3;</span>
        <h2 class="modal-title" id="container-modal-title">CONTAINER ACTION</h2>
      </div>
      <div class="modal-body">
        <p class="modal-text" id="container-modal-text">You are about to perform an action on this container:</p>
        <div class="modal-details">
          <div class="detail-row">
            <span class="detail-label">RUNTIME:</span>
            <span class="detail-value" id="container-modal-runtime">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">NAME:</span>
            <span class="detail-value" id="container-modal-name">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">IMAGE / NS:</span>
            <span class="detail-value" id="container-modal-image">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">ID:</span>
            <span class="detail-value" id="container-modal-id">--</span>
          </div>
        </div>
        <p class="modal-warning" id="container-modal-warning">This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="container-modal-cancel">CANCEL</button>
        <button class="btn btn-danger" id="container-modal-confirm">CONFIRM</button>
      </div>
    </div>
  </div>

  <!-- Status Toast -->
  <div class="toast" id="toast">
    <span class="toast-icon"></span>
    <span class="toast-message"></span>
  </div>

  <script src="app.js"></script>
</body>
</html>
